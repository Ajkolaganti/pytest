(.venv) PS C:\Users\SaiKrishna\PycharmProjects\pytestgit\newPytest\pytest> pytest
========================================================================================================== test session starts ==========================================================================================================
platform win32 -- Python 3.11.9, pytest-8.0.0, pluggy-1.5.0
rootdir: C:\Users\SaiKrishna\PycharmProjects\pytestgit\newPytest\pytest
plugins: html-4.1.1, metadata-3.1.1
collected 4 items

test_graphql_queries.py ..F                                                                                                                                                                                                        [ 75%]
tests\test_counterparties.py .                                                                                                                                                                                                     [100%]

=============================================================================================================== FAILURES ================================================================================================================
__________________________________________________________________________________________________________ test_invalid_query ___________________________________________________________________________________________________________

graphql_client = <conftest.GraphQLClient object at 0x0000023951E17CD0>

    def test_invalid_query(graphql_client):
        """Test handling of invalid query."""
        invalid_query = "{ invalid { field } }"

>       response = graphql_client.execute_query(invalid_query)

test_graphql_queries.py:62:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
conftest.py:100: in execute_query
    response.raise_for_status()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Response [400]>

    def raise_for_status(self):
        """Raises :class:`HTTPError`, if one occurred."""

        http_error_msg = ""
        if isinstance(self.reason, bytes):
            # We attempt to decode utf-8 first because some servers
            # choose to localize their reason strings. If the string
            # isn't utf-8, we fall back to iso-8859-1 for all other
            # encodings. (See PR #3538)
            try:
                reason = self.reason.decode("utf-8")
            except UnicodeDecodeError:
                reason = self.reason.decode("iso-8859-1")
        else:
            reason = self.reason

        if 400 <= self.status_code < 500:
            http_error_msg = (
                f"{self.status_code} Client Error: {reason} for url: {self.url}"
            )

        elif 500 <= self.status_code < 600:
            http_error_msg = (
                f"{self.status_code} Server Error: {reason} for url: {self.url}"
            )

        if http_error_msg:
>           raise HTTPError(http_error_msg, response=self)
E           requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://lv-sub-inv-dev-appsvc.azurewebsites.net/subinvapi/graphql/

..\..\pytest\.venv\Lib\site-packages\requests\models.py:1021: HTTPError
--------------------------------------------------------------------------------------------------------- Captured stdout call ----------------------------------------------------------------------------------------------------------

=== GraphQL Request ===
URL: https://lv-sub-inv-dev-appsvc.azurewebsites.net/subinvapi/graphql/
Headers:
User-Agent: python-requests/2.31.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
Authorization: <token-hidden>
Content-Type: application/json

Cookies:
ARRAffinity: 7d577d29f8e00b2374ddb413016b2f6617c84445e3b963399a9d336135481e13
ARRAffinitySameSite: 7d577d29f8e00b2374ddb413016b2f6617c84445e3b963399a9d336135481e13

Request Payload:
{
  "query": "query { invalid { field } }"
}

=== GraphQL Response ===
Status Code: 400
Response Headers:
Content-Type: application/graphql-response+json; charset=utf-8
Date: Wed, 30 Apr 2025 00:12:11 GMT
Server: Microsoft-IIS/10.0
Transfer-Encoding: chunked
Strict-Transport-Security: max-age=2592000
Request-Context: appId=cid-v1:59368e04-2e6f-4086-9672-604d4ac2de56
X-Powered-By: ASP.NET

Response Body:
{
  "errors": [
    {
      "message": "The field `invalid` does not exist on the type `Query`.",
      "locations": [
        {
          "line": 1,
          "column": 9
        }
      ],
      "extensions": {
        "type": "Query",
        "field": "invalid",
        "responseName": "invalid",
        "specifiedBy": "https://spec.graphql.org/October2021/#sec-Field-Selections-on-Objects-Interfaces-and-Unions-Types"
      }
    }
  ]
}

GraphQL Errors:
- The field `invalid` does not exist on the type `Query`.
  Location: [{'line': 1, 'column': 9}]

Request Error: 400 Client Error: Bad Request for url: https://lv-sub-inv-dev-appsvc.azurewebsites.net/subinvapi/graphql/
Error details:
{
  "errors": [
    {
      "message": "The field `invalid` does not exist on the type `Query`.",
      "locations": [
        {
          "line": 1,
          "column": 9
        }
      ],
      "extensions": {
        "type": "Query",
        "field": "invalid",
        "responseName": "invalid",
        "specifiedBy": "https://spec.graphql.org/October2021/#sec-Field-Selections-on-Objects-Interfaces-and-Unions-Types"
      }
    }
  ]
}
=========================================================================================================== warnings summary ============================================================================================================
test_graphql_queries.py::test_graphql_query[get_expense_details.graphql]
test_graphql_queries.py::test_invalid_query
tests/test_counterparties.py::test_get_counterparties
  C:\Users\SaiKrishna\PycharmProjects\pytestgit\pytest\.venv\Lib\site-packages\urllib3\connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host 'lv-sub-inv-dev-appsvc.azurewebsites.net'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================================================================================================== short test summary info ========================================================================================================
FAILED test_graphql_queries.py::test_invalid_query - requests.exceptions.HTTPError: 400 Client Error: Bad Request for url: https://lv-sub-inv-dev-appsvc.azurewebsites.net/subinvapi/graphql/
================================================================================================ 1 failed, 3 passed, 3 warnings in 2.50s ================================================================================================
(.venv) PS C:\Users\SaiKrishna\PycharmProjects\pytestgit\newPytest\pytest>

